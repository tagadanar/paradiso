<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¬ Cinema Paradiso ğŸ›‹ï¸ğŸ•ğŸ¹ğŸ¦†</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="container" style="position: relative;">
            <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
                <span id="themeIcon">ğŸŒ™</span>
            </button>
            <h1>ğŸ¬ Cinema Paradiso ğŸ›‹ï¸ğŸ•ğŸ¹ğŸ¦†</h1>

            <!-- Profile Selection -->
            <div class="profile-bar">
                <span class="profile-label">Select Identity:</span>
                <div id="profiles"></div>
                <div class="form-inline">
                    <input type="text" id="newProfileName" placeholder="New profile name">
                    <button class="btn-create" onclick="createProfile()">Create</button>
                </div>
            </div>
            <div id="selectedProfile" class="profile-selected"></div>

            <!-- Add Film -->
            <div style="padding: 6px 0 4px 0; border-top: 1px solid #e0e0e0; margin-top: 4px;">
                <div class="form-inline" style="align-items: center;">
                    <span style="font-weight: 600; font-size: 14px; margin-right: 10px;">Add Film:</span>
                    <input type="text" id="searchQuery" placeholder="Search for a film..." style="flex: 1; max-width: 400px;" onkeypress="if(event.key==='Enter') searchFilms()">
                    <button class="btn-search" onclick="searchFilms()">Search</button>
                    <button id="closeSearchBtn" class="btn-close-search" onclick="closeSearch()" style="display: none;">âœ•</button>
                </div>
                <div id="searchResults" class="search-results"></div>
            </div>

            <!-- Filters -->
            <div style="padding: 8px 0 12px 0; border-top: 1px solid #e0e0e0; margin-top: 8px;">
                <div style="display: flex; gap: 6px; flex-wrap: wrap; align-items: center;">
                    <span style="font-weight: 600; font-size: 14px;">Filters:</span>
                    <button id="horrorFilterBtn" class="btn-filter" onclick="cycleHorrorFilter()">
                        ğŸƒğŸ… All Films
                    </button>
                    <button id="unvotedBtn" class="btn-filter" onclick="setVoteFilter('unvoted')">
                        âšª Unvoted
                    </button>
                    <button id="upvotedBtn" class="btn-filter" onclick="setVoteFilter('upvoted')">
                        ğŸ‘ My Upvotes
                    </button>
                    <button id="neutralBtn" class="btn-filter" onclick="setVoteFilter('neutral')">
                        â– My Neutral
                    </button>
                    <button id="downvotedBtn" class="btn-filter" onclick="setVoteFilter('downvoted')">
                        ğŸ‘ My Downvotes
                    </button>
                    <div style="position: relative; display: inline-block;">
                        <button id="identityBtn" class="btn-filter" onclick="toggleIdentityFilter()">
                            ğŸ‘¤ Identities
                        </button>
                        <div id="identityDropdown" class="identity-dropdown">
                            <div style="padding: 8px; border-bottom: 1px solid var(--border-color);">
                                <button class="btn-identity-select-all" onclick="selectAllIdentities()">Select All</button>
                                <button class="btn-identity-clear-all" onclick="clearAllIdentities()">Clear All</button>
                            </div>
                            <div id="identityCheckboxes" style="padding: 8px; max-height: 300px; overflow-y: auto;"></div>
                        </div>
                    </div>
                    <div style="margin-left: auto;">
                        <button id="archiveToggleBtn" class="archive-toggle" onclick="toggleArchiveView()">
                            ğŸ“¦ Show Archived
                        </button>
                    </div>
                </div>
                <!-- Search Films -->
                <div style="margin-top: 6px; display: flex; align-items: center; gap: 12px;">
                    <input type="text" id="filmSearchInput" placeholder="ğŸ” Search films by title, director, actor, genre..."
                           style="flex: 1; max-width: 600px;"
                           oninput="filterFilms()">
                    <button id="sortToggleBtn" class="sort-toggle-btn" onclick="toggleSortMode()" title="Toggle sort mode">
                        ğŸ“Š Sort: Score
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Films List -->
        <div>
            <h2 style="margin-bottom: 16px;">All Films</h2>
            <div id="filmsList"></div>
        </div>
    </div>

    <!-- Archive Date Modal -->
    <div id="archiveDateModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-title" id="modalTitle">Archive Film</div>
            <div class="modal-message">
                <p style="margin-bottom: 12px;">Select archive date:</p>
                <div style="display: flex; gap: 8px; align-items: center;">
                    <input type="text"
                           id="archiveModalDateDisplay"
                           readonly
                           onclick="openArchiveModalDatePicker()"
                           placeholder="Click to select date"
                           style="flex: 1; padding: 10px 12px; border: 2px solid var(--border-color); border-radius: 6px; font-size: 14px; background: var(--bg-secondary); color: var(--text-primary); cursor: pointer;">
                    <input type="date"
                           id="archiveModalDateHidden"
                           onchange="syncArchiveModalDate()"
                           style="position: absolute; opacity: 0; pointer-events: none;">
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-primary" onclick="archiveDateModalAction('validate')">
                    âœ… Validate
                </button>
                <button class="modal-btn modal-btn-cancel" onclick="archiveDateModalAction('cancel')">
                    âœ–ï¸ Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Add Film Teaser Modal -->
    <div id="addFilmTeaserModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-title" id="teaserModalTitle">Add Film</div>
            <div class="modal-message">
                <p>Would you like to add a teaser text for this film?</p>
                <p style="font-size: 0.9em; color: var(--text-secondary);">If you add a teaser, it will be shown instead of the plot and trailer link.</p>
                <textarea id="teaserTextInput" placeholder="Enter your teaser text here (optional)..." style="width: 100%; min-height: 100px; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg-secondary); color: var(--text-color); font-family: inherit; resize: vertical;"></textarea>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-primary" onclick="addFilmTeaserModalAction('add')">
                    â• Add Film
                </button>
                <button class="modal-btn modal-btn-cancel" onclick="addFilmTeaserModalAction('cancel')">
                    âœ–ï¸ Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Fullscreen Poster Modal -->
    <div id="posterFullscreenModal" class="poster-fullscreen-overlay" onclick="closePosterFullscreen()">
        <img id="posterFullscreenImage" class="poster-fullscreen-image" src="" alt="Film Poster">
    </div>

    <!-- Voter Tooltip -->
    <div id="voterTooltip" class="voter-tooltip"></div>

    <script src="app.js"></script>
</body>
</html>
